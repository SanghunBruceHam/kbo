<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBO 2025 ë§¤ì§ë„˜ë²„ & íŠ¸ë˜ì§ë„˜ë²„ ë§¤íŠ¸ë¦­ìŠ¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .info-section {
            background: #f8f9ff;
            border: 2px solid #e3f2fd;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .info-section h3 {
            color: #1a237e;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .legend-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .legend-item h4 {
            color: #3949ab;
            font-size: 1rem;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .legend-item p {
            font-size: 0.9rem;
            color: #64748b;
        }
        
        .matrix-wrapper {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .matrix-title {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }
        
        .matrix-table th {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color: #1e293b;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            border: 1px solid #cbd5e1;
            font-size: 0.8rem;
            line-height: 1.2;
        }
        
        .matrix-table td {
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
            vertical-align: middle;
        }
        
        /* íŒ€ëª… ì»¬ëŸ¼ ìŠ¤íƒ€ì¼ */
        .team-header {
            background: linear-gradient(135deg, #3949ab 0%, #1a237e 100%) !important;
            color: white !important;
            font-weight: 600;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            width: 60px;
            min-width: 60px;
        }
        
        .team-cell {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            font-weight: 600;
            color: #1a237e;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            width: 60px;
            min-width: 60px;
            white-space: pre-line;
            font-size: 0.85rem;
        }
        
        /* ìˆœìœ„ í—¤ë” ìŠ¤íƒ€ì¼ */
        .rank-header {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%) !important;
            color: white !important;
            font-weight: 600;
            min-width: 50px;
        }
        
        /* === 3ê°€ì§€ ìƒ‰ìƒ ì‹œìŠ¤í…œ === */

        /* ë§¤ì§ë„˜ë²„ & íŠ¸ë˜ì§ë„˜ë²„ ê³µí†µ */
        .good { background: #22c55e; color: white; font-weight: bold; }    /* ì´ˆë¡ - ì¢‹ìŒ/ì•ˆì „ */
        .warning { background: #fbbf24; color: #1f2937; font-weight: bold; } /* ë…¸ë€ìƒ‰ - ì „ìŠ¹ í•„ìš”/ìë ¥ ë¶ˆê°€ëŠ¥ */
        .medium { background: #f59e0b; color: white; font-weight: 600; }   /* ì£¼í™© - ë³´í†µ/ê²½í•© */  
        .bad { background: #ef4444; color: white; font-weight: 600; }      /* ë¹¨ê°• - ë‚˜ì¨/ìœ„í—˜ */

        /* í˜„ì¬ ìˆœìœ„ â˜… í‘œì‹œ */
        .current-rank::after {
            content: 'â˜…';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.7rem;
            color: #fbbf24;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .impossible {
            background: #64748b;
            color: white;
            font-style: italic;
        }

        /* ëª¨ë“œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .mode-btn {
            background: #f1f5f9;
            color: #64748b;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 5px;
        }

        .mode-btn:hover {
            background: #e2e8f0;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
        }

        /* í™•ë¥  í‘œì‹œìš© ìƒ‰ìƒ */
        .prob-high { background: #22c55e; color: white; font-weight: bold; } /* 30%+ */
        .prob-medium-high { background: #84cc16; color: white; font-weight: 600; } /* 20-29% */
        .prob-medium { background: #eab308; color: white; font-weight: 600; } /* 10-19% */
        .prob-low { background: #f97316; color: white; font-weight: 600; } /* 5-9% */
        .prob-very-low { background: #ef4444; color: white; font-weight: 600; } /* 1-4% */
        .prob-minimal { background: #dc2626; color: white; font-weight: 600; } /* <1% */
        .prob-zero { background: #64748b; color: white; font-style: italic; } /* 0% */
        
        /* í˜„ì¬ ìˆœìœ„ â˜… í‘œì‹œ (í˜„ì¬ ìˆœìœ„ ê°•ì¡° ì œê±°) */
        .current-rank::after {
            content: 'â˜…';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.7rem;
            color: #fbbf24;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .hover-info {
            position: fixed;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            max-width: 300px;
        }
        
        .footer {
            background: #f1f5f9;
            padding: 20px;
            text-align: center;
            color: #64748b;
            font-size: 0.9rem;
        }
        
        .update-time {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        @media (max-width: 1200px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .matrix-table {
                font-size: 0.75rem;
            }
            
            .matrix-table th, .matrix-table td {
                padding: 6px 4px;
            }
            
            .team-header, .team-cell {
                width: 50px;
                min-width: 50px;
            }
            
            .rank-header {
                min-width: 40px;
            }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .matrix-table {
                font-size: 0.7rem;
            }
            
            .legend {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }
        /* ì‚­ì œ: 2.21 ìŠ¤í¬ë¦°ìƒ· ìŠ¤íƒ€ì¼ í…Œì´ë¸” ê´€ë ¨ CSS */
        /* ìŠ¤í¬ë¦°ìƒ·ì˜ í•˜ë‹¨ ë°°ë„ˆ(í¬ìŠ¤íŠ¸ì‹œì¦Œ ì§„ì¶œ ì‹¤íŒ¨) ìƒ‰ìƒ */
        .cell-merge-fail {
            background: #7a2e2e; /* ì§„í•œ ìì£¼ìƒ‰ í†¤ */
            color: #fff;
            font-weight: 800;
            text-align: center !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† KBO 2025 ë§¤ì§ë„˜ë²„ & íŠ¸ë˜ì§ë„˜ë²„ ë§¤íŠ¸ë¦­ìŠ¤</h1>
            <div class="subtitle">ê° íŒ€ì´ íŠ¹ì • ìˆœìœ„ì— ë„ë‹¬í•˜ê¸° ìœ„í•œ ë§¤ì§ë„˜ë²„ / í•´ë‹¹ ìˆœìœ„ì—ì„œ ë°€ë ¤ë‚˜ëŠ” íŠ¸ë˜ì§ë„˜ë²„</div>
        </div>
        
        <div class="content">
            <div class="update-time" id="updateTime">
                ğŸ“… ë°ì´í„° ì—…ë°ì´íŠ¸: 2025-08-28 12:00
            </div>
            
            <div class="info-section">
                <h3>ğŸ¯ ë§¤íŠ¸ë¦­ìŠ¤ í•µì‹¬ ì›ë¦¬: ìµœì¢… ìŠ¹ë¥  ê¸°ë°˜ ê³„ì‚°</h3>
                <div class="legend">
                    <div class="legend-item">
                        <h4>ğŸ“ˆ ê¸°ë³¸ ê°œë…</h4>
                        <p><strong>ìµœì¢… ìŠ¹ë¥  = ìµœì¢… ìŠ¹ìˆ˜ Ã· (ìµœì¢… ìŠ¹ìˆ˜ + ìµœì¢… íŒ¨ìˆ˜)</strong><br>
                        KBOëŠ” ìŠ¹ë¥ ë¡œ ìˆœìœ„ë¥¼ ê²°ì •í•˜ë¯€ë¡œ, ëª¨ë“  ê³„ì‚°ì´ ìµœì¢… ìŠ¹ë¥ ì„ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
                    </div>
                    
                    <div class="legend-item">
                        <h4>ğŸ”¼ ìƒìœ„ ìˆœìœ„ (íŠ¸ë˜ì§ë„˜ë²„)</h4>
                        <p><strong>ìƒìœ„íŒ€ì˜ ìµœì¢… ìŠ¹ë¥  > ë‚´ ìµœëŒ€ ê°€ëŠ¥ ìŠ¹ë¥ </strong><br>
                        ìƒìœ„íŒ€ì´ ëª‡ ìŠ¹ì„ ë” í•´ì•¼ ë‚´ê°€ ì¶”ì›”í•  ìˆ˜ ì—†ëŠ”ì§€ ê³„ì‚°</p>
                    </div>
                    
                    <div class="legend-item">
                        <h4>â˜… í˜„ì¬ ìˆœìœ„</h4>
                        <p>í˜„ì¬ íŒ€ì˜ ìˆœìœ„ (íŒŒë€ìƒ‰ â˜…ë¡œ í‘œì‹œ)</p>
                    </div>
                    
                    <div class="legend-item">
                        <h4>ğŸ”½ í•˜ìœ„ ìˆœìœ„ (ë§¤ì§ë„˜ë²„)</h4>
                        <p><strong>ë‚´ ìµœì¢… ìŠ¹ë¥  > í•˜ìœ„íŒ€ì˜ ìµœëŒ€ ê°€ëŠ¥ ìŠ¹ë¥ </strong><br>
                        ë‚´ê°€ ëª‡ ìŠ¹ì„ ë” í•´ì•¼ í•˜ìœ„íŒ€ì´ ì¶”ì›”í•  ìˆ˜ ì—†ëŠ”ì§€ ê³„ì‚°</p>
                    </div>
                </div>
            </div>
            
            <div class="info-section">
                <h3>ğŸ“Š ë§¤íŠ¸ë¦­ìŠ¤ ì½ëŠ” ë²•</h3>
                <div class="legend">
                    <div class="legend-item">
                        <h4>ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ ê°€ì •</h4>
                        <p><strong>ë³´ìˆ˜ì  ê³„ì‚°:</strong> ìƒëŒ€íŒ€ì€ ì „ìŠ¹, ë‚´ íŒ€ì€ í•´ë‹¹ ìŠ¹ìˆ˜ë§Œ ë‹¬ì„±<br>
                        <strong>ì˜ˆ:</strong> LGê°€ í•œí™” 1ìœ„ë¥¼ ì¶”ì›”í•˜ë ¤ë©´, í•œí™”ê°€ ì „ìŠ¹í•œë‹¤ê³  ê°€ì •í•˜ê³  ê³„ì‚°</p>
                    </div>
                    
                    <div class="legend-item">
                        <h4>ğŸ“ˆ ìŠ¹ë¥  ë¹„êµ ì˜ˆì‹œ</h4>
                        <p><strong>LG(2ìœ„):</strong> í˜„ì¬ 74ìŠ¹ 44íŒ¨ (0.627)<br>
                        <strong>í•œí™”(1ìœ„):</strong> í˜„ì¬ 69ìŠ¹ 48íŒ¨ (0.590)<br>
                        â†’ LGê°€ ì´ë¯¸ í•œí™”ë³´ë‹¤ ìŠ¹ë¥ ì´ ë†’ì§€ë§Œ, ê²½ê¸°ìˆ˜ ì°¨ì´ë¡œ 2ìœ„</p>
                    </div>
                    
                    <div class="legend-item">
                        <h4>ğŸ”¢ ê³„ì‚° ê³µì‹</h4>
                        <p><strong>ë§¤ì§ë„˜ë²„:</strong> (í•˜ìœ„íŒ€ ìµœëŒ€ìŠ¹ìˆ˜ - ë‚´ìŠ¹ìˆ˜ + 1)<br>
                        <strong>íŠ¸ë˜ì§ë„˜ë²„:</strong> (ìƒìœ„íŒ€ì´ ë‚´ ìµœëŒ€ìŠ¹ë¥ ì„ ë„˜ê¸° ìœ„í•œ ìŠ¹ìˆ˜)<br>
                        <strong>ë¬´ìŠ¹ë¶€:</strong> 0.5ìŠ¹ìœ¼ë¡œ ê³„ì‚°í•˜ì—¬ ìŠ¹ë¥ ì— ë°˜ì˜</p>
                    </div>
                    
                    <div class="legend-item">
                        <h4>ğŸ¨ ìƒ‰ìƒ ì˜ë¯¸</h4>
                        <p>ğŸŸ¢ ì´ˆë¡: í™•ì •/ì•ˆì „ | ğŸŸ¡ ë…¸ë‘: ìœ ë ¥ | ğŸŸ  ì£¼í™©: ê²½í•© | ğŸ”´ ë¹¨ê°•: ìœ„í—˜/ë¶ˆê°€ëŠ¥</p>
                    </div>
                </div>
            </div>
            
            <!-- í‘œì‹œ ëª¨ë“œ ì„ íƒ -->
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="display: inline-flex; background: white; border-radius: 10px; padding: 5px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);">
                    <button id="magicMode" class="mode-btn active" onclick="switchMode('magic')">
                        ğŸ¯ ë§¤ì§ë„˜ë²„/íŠ¸ë˜ì§ë„˜ë²„
                    </button>
                    <button id="scenarioMode" class="mode-btn" onclick="switchMode('scenario')">
                        ğŸ“Š ê²½ìš°ì˜ìˆ˜ í™•ë¥ 
                    </button>
                </div>
            </div>

            <!-- í†µí•© ë§¤ì§ë„˜ë²„/íŠ¸ë˜ì§ë„˜ë²„ ë§¤íŠ¸ë¦­ìŠ¤ -->
            <div class="matrix-wrapper" id="magicMatrixWrapper">
                <div class="matrix-title">
                    ğŸ† ìˆœìœ„ë³„ ë§¤ì§ë„˜ë²„ & íŠ¸ë˜ì§ë„˜ë²„ ë§¤íŠ¸ë¦­ìŠ¤
                    <br><small style="font-size: 0.9rem; opacity: 0.9;">
                        ìƒìœ„ìˆœìœ„(íŠ¸ë˜ì§ë„˜ë²„) | í˜„ì¬ìˆœìœ„(â˜…) | í•˜ìœ„ìˆœìœ„(ë§¤ì§ë„˜ë²„)
                    </small>
                </div>
                <table class="matrix-table" id="unifiedMatrix">
                    <thead>
                        <tr>
                            <th class="team-header">íŒ€ëª…</th>
                            <th class="rank-header">1ìœ„</th>
                            <th class="rank-header">2ìœ„</th>
                            <th class="rank-header">3ìœ„</th>
                            <th class="rank-header">4ìœ„</th>
                            <th class="rank-header">5ìœ„</th>
                            <th class="rank-header">6ìœ„</th>
                            <th class="rank-header">7ìœ„</th>
                            <th class="rank-header">8ìœ„</th>
                            <th class="rank-header">9ìœ„</th>
                            
                        </tr>
                    </thead>
                    <tbody id="unifiedTableBody">
                        <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                    </tbody>
                </table>
            </div>

            <!-- ê²½ìš°ì˜ìˆ˜ í™•ë¥  ë§¤íŠ¸ë¦­ìŠ¤ -->
            <div class="matrix-wrapper" id="scenarioMatrixWrapper" style="display: none;">
                <div class="matrix-title">
                    ğŸ“Š ìˆœìœ„ë³„ ê²½ìš°ì˜ìˆ˜ í™•ë¥  ë§¤íŠ¸ë¦­ìŠ¤
                    <br><small style="font-size: 0.9rem; opacity: 0.9;">
                        ê° íŒ€ì´ í•´ë‹¹ ìˆœìœ„ë¡œ ë§ˆê°í•  í™•ë¥  (1,000íšŒ ì‹œë®¬ë ˆì´ì…˜)
                    </small>
                </div>
                <table class="matrix-table" id="scenarioMatrix">
                    <thead>
                        <tr>
                            <th class="team-header">íŒ€ëª…</th>
                            <th class="rank-header">1ìœ„</th>
                            <th class="rank-header">2ìœ„</th>
                            <th class="rank-header">3ìœ„</th>
                            <th class="rank-header">4ìœ„</th>
                            <th class="rank-header">5ìœ„</th>
                            <th class="rank-header">6ìœ„</th>
                            <th class="rank-header">7ìœ„</th>
                            <th class="rank-header">8ìœ„</th>
                            <th class="rank-header">9ìœ„</th>
                            
                        </tr>
                    </thead>
                    <tbody id="scenarioTableBody">
                        <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                    </tbody>
                </table>
            </div>

            <!-- ì‚­ì œë¨: 2.21 ìŠ¤í¬ë¦°ìƒ· í…Œì´ë¸” -->
            
            <div class="info-section">
                <h3>ğŸ’¡ ê³„ì‚° ë°©ì‹ ì„¤ëª…</h3>
                <div class="legend">
                    <div class="legend-item">
                        <h4>ğŸ”¼ ìƒìœ„ ìˆœìœ„ (íŠ¸ë˜ì§ë„˜ë²„)</h4>
                        <p>ìƒìœ„íŒ€ì´ ë‚˜ì˜ ìµœëŒ€ ìŠ¹ë¥ ì„ ë„˜ì–´ì„œê¸° ìœ„í•´ í•„ìš”í•œ ìŠ¹ìˆ˜. ìƒìœ„íŒ€ ê´€ì ì—ì„œì˜ ë§¤ì§ë„˜ë²„</p>
                    </div>
                    <div class="legend-item">
                        <h4>ğŸ”½ í•˜ìœ„ ìˆœìœ„ (ë§¤ì§ë„˜ë²„)</h4>
                        <p>í•´ë‹¹ ìˆœìœ„ë¥¼ ë°©ì–´í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ìŠ¹ìˆ˜. í•˜ìœ„íŒ€ì´ ì „ìŠ¹í•œë‹¤ê³  ê°€ì •í•˜ê³  ê³„ì‚°</p>
                    </div>
                    <div class="legend-item">
                        <h4>ğŸ¯ íŠ¹ìˆ˜ ìƒí™©</h4>
                        <p>ì¶”ì›”ê°€ëŠ¥: ìƒìœ„íŒ€ì„ ì¶”ì›”í•  ìˆ˜ ìˆìŒ<br>ìˆ˜ë¹„ë¶ˆê°€: í•´ë‹¹ ìˆœìœ„ ë°©ì–´ ë¶ˆê°€ëŠ¥<br>ì•ˆì „: ë°€ë ¤ë‚  ìœ„í—˜ ì—†ìŒ</p>
                    </div>
                    <div class="legend-item">
                        <h4>ğŸ”¢ ê³„ì‚° ê¸°ì¤€</h4>
                        <p>ìŠ¹ë¥  ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°. ë¬´ìŠ¹ë¶€ëŠ” 0.5ìŠ¹ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì •í™•í•œ ìˆœìœ„ ì˜ˆì¸¡</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>&copy; 2025 KBO ë§¤ì§ë„˜ë²„ ê³„ì‚°ê¸°. ëª¨ë“  ë°ì´í„°ëŠ” KBO ê³µì‹ ê¸°ë¡ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
            <p>âš¾ ë§¤íŠ¸ë¦­ìŠ¤ ê³„ì‚°: ìŠ¹ë¥  ê¸°ì¤€, ì”ì—¬ ê²½ê¸° ê³ ë ¤í•œ ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¶„ì„</p>
        </div>
    </div>
    
    <!-- íˆ´íŒ -->
    <div class="hover-info" id="tooltip"></div>

    <script>
        // ë™ì  ê³„ì‚°ì— ì‚¬ìš©í•  í˜„ì¬ ìˆœìœ„ ë°ì´í„° (service-data.json ë¡œë“œ í›„ ì±„ì›€)
        let standingsData = [];
        let scenarioMatrix = null; // ê²½ìš°ì˜ ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤ ìºì‹œ

        // ì„œë¹„ìŠ¤ ë°ì´í„° ë¡œë“œ (ì‹¤ì œ í”„ë¡œì íŠ¸ ë°ì´í„° í™œìš©)
        async function loadStandingsData() {
            try {
                const res = await fetch('./data/service-data.json?v=' + Date.now());
                const json = await res.json();
                // rank ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë¦¬ëœ ê¸°ë³¸ í•„ë“œë§Œ ì¶”ì¶œ
                standingsData = json.standings
                    .sort((a, b) => a.rank - b.rank)
                    .map(t => ({
                        rank: t.rank,
                        team: t.team,
                        wins: t.wins,
                        losses: t.losses,
                        draws: t.draws,
                        remainingGames: t.remainingGames,
                        games: t.games,
                        winRate: t.winRate
                    }));
            } catch (e) {
                console.warn('ì„œë¹„ìŠ¤ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨. í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.', e);
                // ìµœí›„ì˜ ë³´ë£¨: í•˜ë“œì½”ë”©ëœ ì˜ˆì‹œ ë°ì´í„° (ì´ì „ testData)
                standingsData = [
                    { rank: 1, team: "LG", wins: 74, losses: 44, draws: 3, remainingGames: 23, games: 121, winRate: 0.6271 },
                    { rank: 2, team: "í•œí™”", wins: 69, losses: 48, draws: 3, remainingGames: 24, games: 120, winRate: 0.5897 },
                    { rank: 3, team: "SSG", wins: 59, losses: 56, draws: 4, remainingGames: 25, games: 119, winRate: 0.5130 },
                    { rank: 4, team: "ë¡¯ë°", wins: 60, losses: 58, draws: 5, remainingGames: 21, games: 123, winRate: 0.5085 },
                    { rank: 5, team: "KT", wins: 60, losses: 58, draws: 4, remainingGames: 22, games: 122, winRate: 0.5085 },
                    { rank: 6, team: "ì‚¼ì„±", wins: 60, losses: 59, draws: 2, remainingGames: 23, games: 121, winRate: 0.5042 },
                    { rank: 7, team: "NC", wins: 55, losses: 55, draws: 6, remainingGames: 28, games: 116, winRate: 0.5000 },
                    { rank: 8, team: "KIA", wins: 55, losses: 59, draws: 4, remainingGames: 26, games: 118, winRate: 0.4825 },
                    { rank: 9, team: "ë‘ì‚°", wins: 52, losses: 64, draws: 5, remainingGames: 23, games: 121, winRate: 0.4483 },
                    { rank: 10, team: "í‚¤ì›€", wins: 38, losses: 81, draws: 4, remainingGames: 21, games: 123, winRate: 0.3193 }
                ];
            }
        }

        // ì‚­ì œ: 2.21 ìŠ¤í¬ë¦°ìƒ· í…Œì´ë¸” ë Œë”ëŸ¬ ì œê±°

        // ê¸°ì¡´ ìŠ¤í¬ë¦°ìƒ·í˜• í…Œì´ë¸”(Style 2.21)ì˜ ë™ì  ë Œë”ëŸ¬
        // ì‚­ì œ: 2.21 ìŠ¤í¬ë¦°ìƒ· í…Œì´ë¸” ë™ì  ë Œë”ëŸ¬ ì œê±°
        // (ì‚­ì œë¨) testData: ì„œë¹„ìŠ¤ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨ ì‹œ loadStandingsData() ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ì˜ˆë¹„ ë°ì´í„°

        // === ê²½ìš°ì˜ìˆ˜ ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ===
        
        // íŒ€ê°„ ìƒëŒ€ì „ì  ë°ì´í„° (ì‹¤ì œ ë°ì´í„° ê¸°ë°˜)
        const headToHeadData = {
            "LG": {"í•œí™”": "5-7", "SSG": "6-6", "ë¡¯ë°": "7-3", "KT": "8-4", "ì‚¼ì„±": "8-4", "NC": "8-4", "KIA": "8-4", "ë‘ì‚°": "9-3", "í‚¤ì›€": "10-2"},
            "í•œí™”": {"LG": "7-5", "SSG": "6-6", "ë¡¯ë°": "6-6", "KT": "7-5", "ì‚¼ì„±": "7-5", "NC": "8-4", "KIA": "8-4", "ë‘ì‚°": "8-4", "í‚¤ì›€": "9-3"},
            "SSG": {"LG": "6-6", "í•œí™”": "6-6", "ë¡¯ë°": "6-6", "KT": "6-6", "ì‚¼ì„±": "7-5", "NC": "7-5", "KIA": "7-5", "ë‘ì‚°": "8-4", "í‚¤ì›€": "9-3"},
            "ë¡¯ë°": {"LG": "3-7", "í•œí™”": "6-6", "SSG": "6-6", "KT": "6-6", "ì‚¼ì„±": "6-6", "NC": "7-5", "KIA": "7-5", "ë‘ì‚°": "8-4", "í‚¤ì›€": "9-3"},
            "KT": {"LG": "4-8", "í•œí™”": "5-7", "SSG": "6-6", "ë¡¯ë°": "6-6", "ì‚¼ì„±": "6-6", "NC": "7-5", "KIA": "7-5", "ë‘ì‚°": "8-4", "í‚¤ì›€": "9-3"},
            "ì‚¼ì„±": {"LG": "4-8", "í•œí™”": "5-7", "SSG": "5-7", "ë¡¯ë°": "6-6", "KT": "6-6", "NC": "7-5", "KIA": "7-5", "ë‘ì‚°": "8-4", "í‚¤ì›€": "9-3"},
            "NC": {"LG": "4-8", "í•œí™”": "4-8", "SSG": "5-7", "ë¡¯ë°": "5-7", "KT": "5-7", "ì‚¼ì„±": "5-7", "KIA": "6-6", "ë‘ì‚°": "7-5", "í‚¤ì›€": "8-4"},
            "KIA": {"LG": "4-8", "í•œí™”": "4-8", "SSG": "5-7", "ë¡¯ë°": "5-7", "KT": "5-7", "ì‚¼ì„±": "5-7", "NC": "6-6", "ë‘ì‚°": "7-5", "í‚¤ì›€": "8-4"},
            "ë‘ì‚°": {"LG": "3-9", "í•œí™”": "4-8", "SSG": "4-8", "ë¡¯ë°": "4-8", "KT": "4-8", "ì‚¼ì„±": "4-8", "NC": "5-7", "KIA": "5-7", "í‚¤ì›€": "7-5"},
            "í‚¤ì›€": {"LG": "2-10", "í•œí™”": "3-9", "SSG": "3-9", "ë¡¯ë°": "3-9", "KT": "3-9", "ì‚¼ì„±": "3-9", "NC": "4-8", "KIA": "4-8", "ë‘ì‚°": "5-7"}
        };

        // ê²½ìš°ì˜ìˆ˜ ì‹œë®¬ë ˆì´ì…˜ í•¨ìˆ˜
        function generateScenarioMatrix() {
            const scenarios = {};
            const totalSimulations = 1000;
            
            (standingsData || []).forEach(team => {
                scenarios[team.team] = {};
                
                // ê° ìˆœìœ„ë³„ í™•ë¥  ê³„ì‚° (1~9ìœ„)
                for (let rank = 1; rank <= 9; rank++) {
                    let achievableCount = 0;
                    
                    // ëª¬í…Œì¹´ë¥´ë¡œ ì‹œë®¬ë ˆì´ì…˜
                    for (let sim = 0; sim < totalSimulations; sim++) {
                        const simulatedStandings = simulateSeasonEnd();
                        const teamFinalRank = simulatedStandings.find(t => t.team === team.team).rank;
                        
                        if (teamFinalRank === rank) {
                            achievableCount++;
                        }
                    }
                    
                    scenarios[team.team][rank] = {
                        probability: (achievableCount / totalSimulations * 100).toFixed(1),
                        count: achievableCount
                    };
                }
            });
            
            return scenarios;
        }

        // ì‹œì¦Œ ì¢…ë£Œ ì‹œë®¬ë ˆì´ì…˜
        function simulateSeasonEnd() {
            const simulatedTeams = (standingsData || []).map(team => ({
                ...team,
                finalWins: team.wins,
                finalLosses: team.losses,
                finalDraws: team.draws
            }));
            
            // ê° íŒ€ì˜ ë‚¨ì€ ê²½ê¸°ë¥¼ ë¬´ì‘ìœ„ë¡œ ì‹œë®¬ë ˆì´ì…˜
            simulatedTeams.forEach(team => {
                const remainingWins = Math.floor(Math.random() * (team.remainingGames + 1));
                const remainingLosses = team.remainingGames - remainingWins;
                
                team.finalWins += remainingWins;
                team.finalLosses += remainingLosses;
                team.finalWinRate = team.finalWins / (team.finalWins + team.finalLosses);
            });
            
            // ìŠ¹ë¥ ìˆœìœ¼ë¡œ ì •ë ¬
            simulatedTeams.sort((a, b) => {
                if (b.finalWinRate !== a.finalWinRate) {
                    return b.finalWinRate - a.finalWinRate;
                }
                return b.finalWins - a.finalWins;
            });
            
            // ìˆœìœ„ ë¶€ì—¬
            simulatedTeams.forEach((team, index) => {
                team.rank = index + 1;
            });
            
            return simulatedTeams;
        }

        // ê²½ìš°ì˜ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤ëŠ” í•„ìš” ì‹œ ìƒì„± (switchMode ë˜ëŠ” ë Œë” ì‹œ)
        // scenarioMatrix ë³€ìˆ˜ëŠ” ìƒë‹¨ì—ì„œ ì„ ì–¸ë¨

        // === ìµœëŒ€/ìµœì†Œ ìˆœìœ„ ê³„ì‚° í•¨ìˆ˜ë“¤ ===
        
        // ìµœëŒ€ ê°€ëŠ¥ ìˆœìœ„ ê³„ì‚° (ì „ìŠ¹í–ˆì„ ë•Œ)
        function calculateMaxPossibleRank(team, data) {
            const teamMaxWins = team.wins + team.remainingGames;
            const teamMaxWinRate = teamMaxWins / (teamMaxWins + team.losses);
            
            let maxRank = 10; // ìµœì•…ì˜ ê²½ìš°ë¶€í„° ì‹œì‘
            
            // ë‹¤ë¥¸ ëª¨ë“  íŒ€ë“¤ê³¼ ë¹„êµ
            data.forEach(otherTeam => {
                if (otherTeam.team === team.team) return;
                
                // ìƒëŒ€íŒ€ì´ ì „íŒ¨í–ˆì„ ë•Œì˜ ìµœì†Œ ìŠ¹ë¥ 
                const otherMinWins = otherTeam.wins;
                const otherMinWinRate = otherMinWins / (otherMinWins + otherTeam.losses + otherTeam.remainingGames);
                
                // ë‚´ê°€ ì „ìŠ¹í•˜ê³  ìƒëŒ€ê°€ ì „íŒ¨í–ˆì„ ë•Œ ìŠ¹ë¥  ë¹„êµ
                if (teamMaxWinRate > otherMinWinRate) {
                    // ì´ íŒ€ë³´ë‹¤ ë†’ì€ ìˆœìœ„ ê°€ëŠ¥
                    maxRank = Math.min(maxRank, otherTeam.rank);
                }
            });
            
            return maxRank;
        }

        // ìµœì†Œ ê°€ëŠ¥ ìˆœìœ„ ê³„ì‚° (ì „íŒ¨í–ˆì„ ë•Œ)
        function calculateMinPossibleRank(team, data) {
            const teamMinWins = team.wins;
            const teamMinWinRate = teamMinWins / (teamMinWins + team.losses + team.remainingGames);
            
            let minRank = 1; // ìµœì„ ì˜ ê²½ìš°ë¶€í„° ì‹œì‘
            
            // ë‹¤ë¥¸ ëª¨ë“  íŒ€ë“¤ê³¼ ë¹„êµ
            data.forEach(otherTeam => {
                if (otherTeam.team === team.team) return;
                
                // ìƒëŒ€íŒ€ì´ ì „ìŠ¹í–ˆì„ ë•Œì˜ ìµœëŒ€ ìŠ¹ë¥ 
                const otherMaxWins = otherTeam.wins + otherTeam.remainingGames;
                const otherMaxWinRate = otherMaxWins / (otherMaxWins + otherTeam.losses);
                
                // ë‚´ê°€ ì „íŒ¨í•˜ê³  ìƒëŒ€ê°€ ì „ìŠ¹í–ˆì„ ë•Œ ìŠ¹ë¥  ë¹„êµ
                if (otherMaxWinRate > teamMinWinRate) {
                    // ì´ íŒ€ì´ ë‚˜ë³´ë‹¤ ë†’ì€ ìˆœìœ„ ê°€ëŠ¥
                    minRank = Math.max(minRank, otherTeam.rank + 1);
                }
            });
            
            return Math.min(minRank, 10); // ìµœëŒ€ 10ìœ„
        }

        // ìˆœìœ„ ê°€ëŠ¥ì„± ê³„ì‚°
        function calculateRankPossibility(team, targetRank, data) {
            const maxRank = calculateMaxPossibleRank(team, data);
            const minRank = calculateMinPossibleRank(team, data);
            
            if (targetRank < maxRank) {
                return {
                    possible: false,
                    reason: `ìµœëŒ€ ${maxRank}ìœ„ê¹Œì§€ë§Œ ê°€ëŠ¥`
                };
            }
            
            if (targetRank > minRank) {
                return {
                    possible: false,
                    reason: `ìµœì†Œ ${minRank}ìœ„ê¹Œì§€ë§Œ ê°€ëŠ¥`
                };
            }
            
            return {
                possible: true,
                reason: 'ë‹¬ì„± ê°€ëŠ¥'
            };
        }

        // íŠ¹ì • ìˆœìœ„ ë‹¬ì„±ì„ ìœ„í•œ ìµœì†Œ ìŠ¹ìˆ˜ ê³„ì‚°
        function calculateWinsNeededForRank(team, targetRank, data) {
            if (team.rank === targetRank) return 0;
            
            // ëª©í‘œ ìˆœìœ„ë³´ë‹¤ ë†’ì€ ìˆœìœ„ë¥¼ ì›í•˜ëŠ” ê²½ìš° (ìƒìŠ¹)
            if (targetRank < team.rank) {
                let maxNeededWins = 0;
                
                // ëª©í‘œ ìˆœìœ„ ì´ìƒì˜ ëª¨ë“  íŒ€ë“¤ì„ ì¶”ì›”í•´ì•¼ í•¨
                for (let i = 0; i < targetRank; i++) {
                    const targetTeam = data[i];
                    if (targetTeam.team === team.team) continue;
                    
                    // í•´ë‹¹ íŒ€ì´ ì „ìŠ¹í•œë‹¤ê³  ê°€ì •
                    const targetTeamMaxWins = targetTeam.wins + targetTeam.remainingGames;
                    const neededWins = Math.max(0, targetTeamMaxWins - team.wins + 1);
                    maxNeededWins = Math.max(maxNeededWins, neededWins);
                }
                
                return maxNeededWins > team.remainingGames ? 'ë¶ˆê°€ëŠ¥' : maxNeededWins;
            }
            
            // ëª©í‘œ ìˆœìœ„ë³´ë‹¤ ë‚®ì€ ìˆœìœ„ë¡œ ë–¨ì–´ì§€ì§€ ì•Šê¸° ìœ„í•œ ê²½ìš° (ë°©ì–´)
            if (targetRank > team.rank) {
                let minNeededWins = 0;
                
                // ëª©í‘œ ìˆœìœ„ ì´í•˜ì˜ íŒ€ë“¤ì´ ë‚˜ë¥¼ ì¶”ì›”í•˜ì§€ ëª»í•˜ë„ë¡ í•´ì•¼ í•¨
                for (let i = targetRank - 1; i < data.length; i++) {
                    const challengerTeam = data[i];
                    if (challengerTeam.team === team.team) continue;
                    
                    // ë„ì „ìê°€ ì „ìŠ¹í•œë‹¤ê³  ê°€ì •
                    const challengerMaxWins = challengerTeam.wins + challengerTeam.remainingGames;
                    const neededWins = Math.max(0, challengerMaxWins - team.wins + 1);
                    minNeededWins = Math.max(minNeededWins, neededWins);
                }
                
                return minNeededWins > team.remainingGames ? 'ë¶ˆê°€ëŠ¥' : minNeededWins;
            }
            
            return 0;
        }

        // === ê¸°ì¡´ ë§¤ì§ë„˜ë²„ ê³„ì‚° í•¨ìˆ˜ë“¤ ë³µì‚¬ ===
        
        // í”Œë ˆì´ì˜¤í”„ ë§¤ì§ë„˜ë²„ ê³„ì‚°
        function calculatePlayoffMagic(team, rankings, index) {
            const totalGames = 144;
            const playoffSpots = 5;
            const remainingGames = totalGames - (team.wins + team.losses + team.draws);
            
            if (index < playoffSpots) {
                // í˜„ì¬ í”Œë ˆì´ì˜¤í”„ ê¶Œ ë‚´
                const sixthPlace = rankings[playoffSpots];
                if (!sixthPlace) return 0;
                const sixthMaxWins = sixthPlace.wins + (totalGames - (sixthPlace.wins + sixthPlace.losses + sixthPlace.draws));
                return Math.max(0, sixthMaxWins - team.wins + 1);
            } else {
                // í”Œë ˆì´ì˜¤í”„ ê¶Œ ë°–
                const fifthPlace = rankings[playoffSpots - 1];
                const maxPossibleWins = team.wins + remainingGames;
                if (maxPossibleWins <= fifthPlace.wins) return team.remainingGames;
                return Math.max(0, fifthPlace.wins - team.wins + 1);
            }
        }

        // íŠ¸ë˜ì§ë„˜ë²„ ê³„ì‚°
        function calculateTragicNumber(team, rankings, index) {
            const totalGames = 144;
            const remainingGames = totalGames - (team.wins + team.losses + team.draws);
            const playoffSpots = 5;
            
            if (index < playoffSpots) {
                // í”Œë ˆì´ì˜¤í”„ ê¶Œ ë‚´ - íƒˆë½ê¹Œì§€
                const sixthPlace = rankings[playoffSpots];
                if (!sixthPlace) return team.remainingGames;
                const minPossibleWins = team.wins;
                const sixthMinWins = sixthPlace.wins;
                if (minPossibleWins > sixthMinWins) return team.remainingGames;
                return Math.max(0, remainingGames - (team.wins - sixthPlace.wins) + 1);
            } else {
                // í”Œë ˆì´ì˜¤í”„ ê¶Œ ë°–
                const baselineWins = 71; // í”Œë ˆì´ì˜¤í”„ ì§„ì¶œ ê¸°ì¤€ì„ 
                const maxPossibleWins = team.wins + remainingGames;
                if (maxPossibleWins >= baselineWins) {
                    return Math.max(0, maxPossibleWins - baselineWins + 1);
                }
                return 0; // ì´ë¯¸ íƒˆë½
            }
        }

        // 1ìœ„ íƒˆí™˜ì„ ìœ„í•œ íŠ¸ë˜ì§ë„˜ë²„ ê³„ì‚° (ìŠ¹ë¥  ê¸°ì¤€, ìŠ¹ìˆ˜ í‘œì‹œ)
        function calculateFirstPlaceTragicNumber(team, rankings, index) {
            const totalGames = 144;
            const remainingGames = totalGames - (team.wins + team.losses + team.draws);
            
            // 1ìœ„íŒ€ ì •ë³´
            const firstPlace = rankings[0];
            if (!firstPlace || team.team === firstPlace.team) {
                return 0; // ì´ë¯¸ 1ìœ„ì´ê±°ë‚˜ 1ìœ„íŒ€ ì •ë³´ê°€ ì—†ìŒ
            }
            
            // í˜„ì¬ íŒ€ì˜ ìµœëŒ€ ê°€ëŠ¥ ìŠ¹ë¥  ê³„ì‚°
            const teamMaxPossibleWins = team.wins + remainingGames;
            const teamMaxPossibleWinRate = teamMaxPossibleWins / (teamMaxPossibleWins + team.losses);
            
            // 1ìœ„íŒ€ ì”ì—¬ ê²½ê¸° ê³„ì‚°
            const firstRemainingGames = totalGames - (firstPlace.wins + firstPlace.losses + firstPlace.draws);
            
            // 1ìœ„íŒ€ì˜ ìµœì € ê°€ëŠ¥ ìŠ¹ë¥ ê³¼ í˜„ì¬ íŒ€ì˜ ìµœëŒ€ ìŠ¹ë¥  ë¹„êµ
            const firstMinWins = firstPlace.wins; // 1ìœ„íŒ€ì´ ì „íŒ¨í•  ë•Œì˜ ìŠ¹ìˆ˜
            const firstMinWinRate = firstMinWins / (firstMinWins + firstPlace.losses + firstRemainingGames);
            
            // í˜„ì¬ íŒ€ì´ ì „ìŠ¹í•´ë„ 1ìœ„íŒ€ì´ ì „íŒ¨í–ˆì„ ë•Œì˜ ìŠ¹ë¥ ì„ ëª» ë„˜ìœ¼ë©´ 1ìœ„ íƒˆí™˜ ë¶ˆê°€ëŠ¥
            if (teamMaxPossibleWinRate <= firstMinWinRate) {
                return team.remainingGames; // 1ìœ„ íƒˆí™˜ ë¶ˆê°€ëŠ¥
            }
            
            // 1ìœ„íŒ€ì´ ëª‡ ìŠ¹ì„ ë” í•´ì•¼ í˜„ì¬ íŒ€ì˜ ìµœëŒ€ ìŠ¹ë¥ ì„ ë„˜ëŠ”ì§€ ê³„ì‚°
            for (let additionalWins = 0; additionalWins <= firstRemainingGames; additionalWins++) {
                const firstFinalWins = firstPlace.wins + additionalWins;
                const firstFinalLosses = firstPlace.losses + (firstRemainingGames - additionalWins);
                const firstFinalWinRate = firstFinalWins / (firstFinalWins + firstFinalLosses);
                
                // 1ìœ„íŒ€ì˜ ìµœì¢… ìŠ¹ë¥ ì´ í˜„ì¬ íŒ€ì˜ ìµœëŒ€ ìŠ¹ë¥ ì„ ë„˜ëŠ”ì§€ í™•ì¸
                if (firstFinalWinRate > teamMaxPossibleWinRate) {
                    return additionalWins; // 1ìœ„íŒ€ì´ ì´ë§Œí¼ ìŠ¹ë¦¬í•˜ë©´ í˜„ì¬ íŒ€ì´ 1ìœ„ íƒˆí™˜ ë¶ˆê°€
                }
            }
            
            // 1ìœ„íŒ€ì´ ì „íŒ¨í•´ë„ í˜„ì¬ íŒ€ì˜ ìµœëŒ€ ìŠ¹ë¥ ì„ ë„˜ì§€ ëª»í•¨ (1ìœ„ íƒˆí™˜ ê°€ëŠ¥)
            return 0;
        }

        // ì •ê·œì‹œì¦Œ ìš°ìŠ¹ ë§¤ì§ë„˜ë²„ ê³„ì‚°
        function calculateChampionshipMagic(team, rankings, index) {
            if (index !== 0) return null; // 1ìœ„ê°€ ì•„ë‹ˆë©´ í•´ë‹¹ì—†ìŒ
            
            const totalGames = 144;
            const secondPlace = rankings[1];
            if (!secondPlace) return 0;
            
            const secondMaxWins = secondPlace.wins + (totalGames - (secondPlace.wins + secondPlace.losses + secondPlace.draws));
            const magic = Math.max(0, secondMaxWins - team.wins + 1);
            return magic;
        }

        // íŒ€ ìƒíƒœ ê²°ì •
        function determineTeamStatus(team, championshipMagic, playoffMagic, tragicNumber, index) {
            // ìš°ìŠ¹ í™•ì •
            if (championshipMagic === 0 || (index === 0 && championshipMagic <= 3)) {
                return {
                    label: 'ìš°ìŠ¹í™•ì •',
                    backgroundColor: '#2563eb',
                    textColor: '#ffffff'
                };
            }
            
            // í”Œë ˆì´ì˜¤í”„ í™•ì •
            if (playoffMagic === 0 || playoffMagic <= 3) {
                return {
                    label: 'POí™•ì •',
                    backgroundColor: '#2563eb',
                    textColor: '#ffffff'
                };
            }
            
            // ë§¤ì§ë„˜ë²„ (ìœ ë ¥)
            if (playoffMagic <= 10) {
                return {
                    label: 'POìœ ë ¥',
                    backgroundColor: '#16a34a',
                    textColor: '#ffffff'
                };
            }
            
            // ê²½í•©
            if (playoffMagic <= 20 && tragicNumber > 10) {
                return {
                    label: 'ê²½í•©',
                    backgroundColor: '#eab308',
                    textColor: '#000000'
                };
            }
            
            // íƒˆë½ ìœ„í—˜
            if (tragicNumber <= 5) {
                return {
                    label: 'íƒˆë½ìœ„í—˜',
                    backgroundColor: '#dc2626',
                    textColor: '#ffffff'
                };
            }
            
            // íƒˆë½
            if (tragicNumber === 0) {
                return {
                    label: 'íƒˆë½',
                    backgroundColor: '#991b1b',
                    textColor: '#ffffff'
                };
            }
            
            // ê¸°ë³¸ (ê²½í•©)
            return {
                label: 'ê²½í•©',
                backgroundColor: '#eab308',
                textColor: '#000000'
            };
        }

        // === ìƒˆë¡œìš´ ë§¤íŠ¸ë¦­ìŠ¤ìš© ê³„ì‚° í•¨ìˆ˜ (í…ŒìŠ¤íŠ¸ìš©) ===
        
        // íŒ€ë³„ ìˆœìœ„ í™•ë³´ ë§¤ì§ë„˜ë²„ ê³„ì‚° (í…ŒìŠ¤íŠ¸ìš© - í•´ë‹¹ ìˆœìœ„ í™•ë³´ë¥¼ ìœ„í•´ í•„ìš”í•œ ìŠ¹ìˆ˜)
        function calculateTeamMagicForRank(team, targetRank, data) {
            // ëª¨ë“  íŒ€ì˜ ìµœëŒ€ ìŠ¹ë¥  ê³„ì‚°
            const allTeamsMaxWinRate = data.map(t => {
                const maxWins = t.wins + t.remainingGames;
                const maxLosses = t.losses; // ì „ìŠ¹ ê°€ì •
                return {
                    team: t.team,
                    maxWinRate: maxWins / (maxWins + maxLosses)
                };
            }).sort((a, b) => b.maxWinRate - a.maxWinRate); // ìŠ¹ë¥  ë†’ì€ ìˆœìœ¼ë¡œ ì •ë ¬
            
            // targetRankë³´ë‹¤ ë†’ì€ ìŠ¹ë¥ ì„ ê°€ì§ˆ ìˆ˜ ìˆëŠ” íŒ€ì˜ ìˆ˜ ê³„ì‚°
            // teamì´ XìŠ¹ì„ í–ˆì„ ë•Œ, ê·¸ë³´ë‹¤ ë†’ì€ ìŠ¹ë¥ ì„ ê¸°ë¡í•  ìˆ˜ ìˆëŠ” íŒ€ì´ (targetRank-1)ê°œ ì´í•˜ì—¬ì•¼ í•¨
            
            for (let teamWins = 0; teamWins <= team.remainingGames; teamWins++) {
                const teamFinalWins = team.wins + teamWins;
                const teamFinalLosses = team.losses + (team.remainingGames - teamWins);
                const teamFinalWinRate = teamFinalWins / (teamFinalWins + teamFinalLosses);
                
                // teamë³´ë‹¤ ë†’ê±°ë‚˜ ê°™ì€ ìŠ¹ë¥ ì„ ê°€ì§ˆ ìˆ˜ ìˆëŠ” íŒ€ì˜ ìˆ˜ (ë™ë¥  í¬í•¨)
                const higherOrEqualTeamsCount = allTeamsMaxWinRate.filter(t => 
                    t.team !== team.team && t.maxWinRate >= teamFinalWinRate
                ).length;
                
                // ë™ë¥ ì´ìƒ íŒ€ì´ (targetRank-1)ê°œ ì´í•˜ë©´ targetRank í™•ë³´
                if (higherOrEqualTeamsCount <= targetRank - 1) {
                    return teamWins;
                }
            }
            
            // ì „ìŠ¹í•´ë„ ë¶ˆê°€ëŠ¥
            return team.remainingGames;
        }

        // ìˆœìœ„ë³„ ê°’ ê³„ì‚° (í…ŒìŠ¤íŠ¸ìš© - ë§¤ì§ë„˜ë²„/íŠ¸ë˜ì§ë„˜ë²„ í†µí•©)
        function calculateRankValue(team, targetRank, data) {
            const currentRank = team.rank;
            
            // ìƒìœ„ ìˆœìœ„ì¸ ê²½ìš° - íŠ¸ë˜ì§ë„˜ë²„ (ìƒìœ„íŒ€ì´ ëª‡ ìŠ¹ ë” í•˜ë©´ ë‚´ê°€ í•´ë‹¹ ìˆœìœ„ ëª» ì°¨ì§€í•˜ëŠ”ì§€)
            if (targetRank < currentRank) {
                const targetTeam = data.find(t => t.rank === targetRank);
                if (!targetTeam) return { value: 'X', type: 'tragic' };
                
                // ìƒìœ„íŒ€ì´ ëª‡ ìŠ¹ ë” í•˜ë©´ ë‚´ê°€ ì „ìŠ¹í•´ë„ ì¶”ì›” ë¶ˆê°€ëŠ¥í•œì§€ ê³„ì‚°
                const myMaxWins = team.wins + team.remainingGames;
                const myMaxLosses = team.losses; // ì „ìŠ¹í•˜ë¯€ë¡œ íŒ¨ìˆ˜ëŠ” ê·¸ëŒ€ë¡œ
                const myMaxWinRate = myMaxWins / (myMaxWins + myMaxLosses);
                
                // ìƒìœ„íŒ€ì´ ëª‡ ìŠ¹ ë” í•˜ë©´ ë‚´ ìµœëŒ€ ìŠ¹ë¥ ì„ ë„˜ëŠ”ì§€
                for (let additionalWins = 0; additionalWins <= targetTeam.remainingGames; additionalWins++) {
                    const targetFinalWins = targetTeam.wins + additionalWins;
                    const targetFinalLosses = targetTeam.losses + (targetTeam.remainingGames - additionalWins);
                    const targetFinalWinRate = targetFinalWins / (targetFinalWins + targetFinalLosses);
                    
                    if (targetFinalWinRate > myMaxWinRate) {
                        return { value: additionalWins, type: 'tragic' };
                    }
                }
                
                // ìƒìœ„íŒ€ì´ ì „íŒ¨í•´ë„ ë‚´ê°€ ì¶”ì›”í•  ìˆ˜ ìˆìŒ
                return { value: 0, type: 'tragic' };
            }
            
            // í˜„ì¬ ìˆœìœ„ ì´í•˜ì¸ ê²½ìš° - ë§¤ì§ë„˜ë²„ (í•´ë‹¹ ìˆœìœ„ í™•ë³´/ìœ ì§€í•˜ê¸° ìœ„í•´ ë‚´ê°€ ëª‡ ìŠ¹ í•´ì•¼ í•˜ëŠ”ì§€)
            if (targetRank >= currentRank) {
                const magic = calculateTeamMagicForRank(team, targetRank, data);
                
                // í˜„ì¬ ìˆœìœ„ë©´ current íƒ€ì…
                const type = (targetRank === currentRank) ? 'current' : 'magic';
                
                return { 
                    value: magic > team.remainingGames ? 'X' : magic, 
                    type: type 
                };
            }
        }

        // === ê¸°ì¡´ í•¨ìˆ˜ë“¤ (ì‚¬ìš© ì•ˆí•¨ - í…ŒìŠ¤íŠ¸ìš© í•¨ìˆ˜ë¡œ ëŒ€ì²´) ===
        
        // (ì‚­ì œë¨) calculateCurrentRankDefense 
        // (ì‚­ì œë¨) calculateTragicNumber
        // (ì‚­ì œë¨) calculateMagicNumber

        // ì…€ ìƒ‰ìƒ í´ë˜ìŠ¤ ê²°ì • (í…ŒìŠ¤íŠ¸ìš© - 3ê°€ì§€ ìƒ‰ìƒ)
        function getCellClass(resultObj) {
            const { type } = resultObj;
            // ë‹¨ìˆœí™”: íƒ€ì… ê¸°ë°˜ ì»¬ëŸ¬ ë§¤í•‘ìœ¼ë¡œ ì‹œê°ì  ì¼ê´€ì„± í™•ë³´
            if (type === 'magic' || type === 'current') return 'good';
            if (type === 'tragic') return 'bad';
            return 'medium';
        }

        // í†µí•© ë§¤íŠ¸ë¦­ìŠ¤ ë Œë”ë§ (í…ŒìŠ¤íŠ¸ìš© - ìƒˆë¡œìš´ ë¡œì§)
        function renderUnifiedMatrix() {
            const tbody = document.getElementById('unifiedTableBody');
            tbody.innerHTML = '';
            
            standingsData.forEach((team, teamIndex) => {
                const row = document.createElement('tr');
                
                // íŒ€ëª… ì…€ (ìˆœìœ„ í¬í•¨)
                const teamCell = document.createElement('td');
                teamCell.className = 'team-cell';
                teamCell.textContent = `${team.rank}ìœ„\n${team.team}`;
                row.appendChild(teamCell);
                
                // ê° ìˆœìœ„ë³„ ê°’ ê³„ì‚° (1~9ìœ„)
                for (let targetRank = 1; targetRank <= 9; targetRank++) {
                    const cell = document.createElement('td');
                    const result = calculateRankValue(team, targetRank, standingsData);
                    
                    // ë””ë²„ê¹…ìš© ë¡œê·¸ (í…ŒìŠ¤íŠ¸ìš©)
                    if (team.team === 'LG' && targetRank === 4) {
                        console.log('LG 4ìœ„ ê³„ì‚° ê²°ê³¼:', result);
                    }
                    
                    cell.textContent = result.value;
                    cell.className = getCellClass(result);
                    
                    // íˆ´íŒ ì´ë²¤íŠ¸
                    cell.addEventListener('mouseenter', (e) => showTooltip(e, team, targetRank, result));
                    cell.addEventListener('mouseleave', hideTooltip);
                    cell.addEventListener('mousemove', moveTooltip);
                    
                    row.appendChild(cell);
                }
                
                tbody.appendChild(row);
            });
        }

        // íˆ´íŒ ê¸°ëŠ¥ (í…ŒìŠ¤íŠ¸ìš© - ìƒˆë¡œìš´ ë¡œì§)
        function showTooltip(e, team, rank, result) {
            const tooltip = document.getElementById('tooltip');
            const { value, type } = result;
            
            let message = `${team.team} â†’ ${rank}ìœ„: `;
            
            if (type === 'current') {
                message += `í˜„ì¬ ìˆœìœ„ â˜…`;
            } else if (type === 'tragic') {
                message += `íŠ¸ë˜ì§ë„˜ë²„ ${value}`;
                const n = parseInt(value);
                if (!isNaN(n) && n === 0) {
                    message += '<br>ìƒìœ„íŒ€ì„ ì¶”ì›”í•  ìˆ˜ ìˆìŒ (ìƒëŒ€ ì¶”ê°€ ìŠ¹ë¦¬ ë¶ˆí•„ìš”)';
                } else if (!isNaN(n)) {
                    message += `<br>${rank}ìœ„/í•´ë‹¹ êµ¬ê°„ íŒ€ì´ ${n}ìŠ¹ ë” í•˜ë©´ ë‹¬ì„±/ë°©ì–´ ë¶ˆê°€`;
                }
            } else if (type === 'magic') {
                message += `ë§¤ì§ë„˜ë²„ ${value}`;
                if (value === 'ìˆ˜ë¹„ë¶ˆê°€') {
                    message += '<br>í•´ë‹¹ ìˆœìœ„ ë°©ì–´ ë¶ˆê°€ëŠ¥';
                } else if (value === 'ì•ˆì „') {
                    message += '<br>í•´ë‹¹ ìˆœìœ„ì—ì„œ ë°€ë ¤ë‚  ìœ„í—˜ ì—†ìŒ';
                } else if (!isNaN(parseInt(value))) {
                    const n = parseInt(value);
                    if (n === 0) message += '<br>í˜„ì¬ ì”ì—¬ ê²½ê¸° ìƒê´€ì—†ì´ ì•ˆì „';
                    else message += `<br>${n}ìŠ¹ ë” í•˜ë©´ ${rank}ìœ„ ì•ˆì „`;
                }
            } else if (type === 'possible') {
                message += 'ì¶”ì›” ê°€ëŠ¥ì„±';
                message += '<br>ìƒìœ„íŒ€ì„ ì¶”ì›”í•  ìˆ˜ ìˆëŠ” ìƒí™©';
            } else if (type === 'impossible') {
                message += 'ë¶ˆê°€ëŠ¥';
                message += '<br>ë‚¨ì€ ê²½ê¸°ë¡œ ë‹¬ì„±/ë°©ì–´ ë¶ˆê°€ëŠ¥';
            }
            
            tooltip.innerHTML = message;
            tooltip.style.opacity = '1';
            moveTooltip(e);
        }

        function hideTooltip() {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.opacity = '0';
        }

        function moveTooltip(e) {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.left = (e.clientX + 15) + 'px';
            tooltip.style.top = (e.clientY - 10) + 'px';
        }

        // ëª¨ë“œ ì „í™˜ í•¨ìˆ˜
        function switchMode(mode) {
            const magicBtn = document.getElementById('magicMode');
            const scenarioBtn = document.getElementById('scenarioMode');
            const magicWrapper = document.getElementById('magicMatrixWrapper');
            const scenarioWrapper = document.getElementById('scenarioMatrixWrapper');
            
            if (mode === 'magic') {
                magicBtn.classList.add('active');
                scenarioBtn.classList.remove('active');
                magicWrapper.style.display = 'block';
                scenarioWrapper.style.display = 'none';
            } else {
                magicBtn.classList.remove('active');
                scenarioBtn.classList.add('active');
                magicWrapper.style.display = 'none';
                scenarioWrapper.style.display = 'block';
                
                // ê²½ìš°ì˜ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤ê°€ ì•„ì§ ë Œë”ë§ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë Œë”ë§
                if (!document.getElementById('scenarioTableBody').hasChildNodes()) {
                    renderScenarioMatrix();
                }
            }
        }

        // ê²½ìš°ì˜ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤ ë Œë”ë§
        function renderScenarioMatrix() {
            const tbody = document.getElementById('scenarioTableBody');
            tbody.innerHTML = '';
            
            if (!scenarioMatrix) scenarioMatrix = generateScenarioMatrix();

            standingsData.forEach((team, teamIndex) => {
                const row = document.createElement('tr');
                
                // íŒ€ëª… ì…€ (ìˆœìœ„ í¬í•¨)
                const teamCell = document.createElement('td');
                teamCell.className = 'team-cell';
                teamCell.textContent = `${team.rank}ìœ„\n${team.team}`;
                row.appendChild(teamCell);
                
                // ê° ìˆœìœ„ë³„ í™•ë¥  í‘œì‹œ (1~9ìœ„)
                for (let targetRank = 1; targetRank <= 9; targetRank++) {
                    const cell = document.createElement('td');
                    const probability = parseFloat(scenarioMatrix[team.team][targetRank].probability);
                    
                    cell.textContent = probability > 0 ? `${probability}%` : '-';
                    cell.className = getProbabilityClass(probability);
                    
                    // í˜„ì¬ ìˆœìœ„ì—ë§Œ â˜… í‘œì‹œ
                    if (team.rank === targetRank) {
                        cell.classList.add('current-rank');
                    }
                    
                    // íˆ´íŒ ì´ë²¤íŠ¸
                    cell.addEventListener('mouseenter', (e) => showProbabilityTooltip(e, team, targetRank, probability));
                    cell.addEventListener('mouseleave', hideTooltip);
                    cell.addEventListener('mousemove', moveTooltip);
                    
                    row.appendChild(cell);
                }
                
                tbody.appendChild(row);
            });
        }

        // í™•ë¥ ë³„ ìƒ‰ìƒ í´ë˜ìŠ¤ ê²°ì •
        function getProbabilityClass(probability) {
            if (probability >= 30) return 'prob-high';
            if (probability >= 20) return 'prob-medium-high';
            if (probability >= 10) return 'prob-medium';
            if (probability >= 5) return 'prob-low';
            if (probability >= 1) return 'prob-very-low';
            if (probability > 0) return 'prob-minimal';
            return 'prob-zero';
        }

        // í™•ë¥  íˆ´íŒ
        function showProbabilityTooltip(e, team, rank, probability) {
            const tooltip = document.getElementById('tooltip');
            
            let message = `${team.team} â†’ ${rank}ìœ„ í™•ë¥ : ${probability}%`;
            
            if (probability >= 30) {
                message += '<br>ë§¤ìš° ë†’ì€ í™•ë¥ ';
            } else if (probability >= 10) {
                message += '<br>ê°€ëŠ¥ì„± ìˆìŒ';
            } else if (probability >= 1) {
                message += '<br>ë‚®ì€ í™•ë¥ ';
            } else if (probability > 0) {
                message += '<br>í¬ë°•í•œ ê°€ëŠ¥ì„±';
            } else {
                message += '<br>ë¶ˆê°€ëŠ¥';
            }
            
            message += `<br>1,000íšŒ ì‹œë®¬ë ˆì´ì…˜ ì¤‘ ${scenarioMatrix[team.team][rank].count}íšŒ`;
            
            tooltip.innerHTML = message;
            tooltip.style.opacity = '1';
            moveTooltip(e);
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ: ì„œë¹„ìŠ¤ ë°ì´í„° ë¡œë“œ â†’ ë§¤íŠ¸ë¦­ìŠ¤ ë Œë”ë§
        document.addEventListener('DOMContentLoaded', async function() {
            await loadStandingsData();
            renderUnifiedMatrix();
            // í˜„ì¬ ì‹œê°„ í‘œì‹œ
            const now = new Date();
            const timeString = now.toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                timeZone: 'Asia/Seoul'
            });
            document.getElementById('updateTime').textContent = `ğŸ“… ë°ì´í„° ì—…ë°ì´íŠ¸: ${timeString}`;
        });
    </script>
</body>
</html>
